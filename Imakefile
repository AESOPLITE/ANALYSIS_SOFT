####################################################################################
##makefile for Main program
####################################################################################

#include "conf/makejsf.tmpl"



INSTALLDIR = $(PWD)
SRCDIR     = $(INSTALLDIR)/src
PROGRAMNAME = MainRecoEventMC

SRCS          =  MainRecoEventMC.$(SrcSuf) \
                $(SRCDIR)/ALSim/MakeRawBPDEvent.$(SrcSuf) \
		$(SRCDIR)/ALSim/MakeEventData.$(SrcSuf)    \
	        $(SRCDIR)/ALSim/MakeRawEventMC.$(SrcSuf)  \
		$(SRCDIR)/ALKalman/ALKalman.$(SrcSuf) \
		$(SRCDIR)/ALPatternRecognition/ALPatternRecognition.$(SrcSuf) \
			

OBJS	      =	$(subst .$(SrcSuf),.$(ObjSuf),$(SRCS)) \
		$(PROGRAMNAME)Dict.$(ObjSuf)

HDRS	      = $(subst .$(SrcSuf),.h,$(SRCS))

DICTNAME      = $(PROGRAMNAME)Dict

PROGRAM    = prod/$(PROGRAMNAME)

LIBINSTALLDIR = $(INSTALLDIR)/lib
INCINSTALLDIR = $(INSTALLDIR)/include
INCPATH	      = -I. -I$(INCINSTALLDIR)
CXXFLAGS     += $(INCPATH) -O -g
#if 0
CXXFLAGS     += -pg
LDFLAGS      += -pg
#endif


all:: $(PROGRAM)

dir:
	mkdir -p prod

$(PROGRAM): $(OBJS) dir
	$(LD) -o $(PROGRAM) $(OBJS) \
	      -L$(LIBINSTALLDIR) -lALSim -lS4Geom -lS4KalTrack -lS4Kalman  -lS4Utils -lS4ALPatternReco -lS4ALKalman \
	      $(LDFLAGS)
clean:: 
	@rm -f $(OBJS) prod/core

depend:: $(SRCS) $(HDRS)
	for i in $(SRCS); do \
	rmkdepend -a -- $(CXXFLAGS) $(INCPATH) $(DEPENDFILES) -- $$i; done

distclean:: clean
	@rm -f $(PROGRAM) Makefile $(DICTNAME).*
	@(cd prod; rm -f *.root *.out *~)

$(DICTNAME).$(SrcSuf): $(HDRS) LinkDef.h
	@echo "Generating dictionary ..."
	rootcint -f $(DICTNAME).$(SrcSuf) \
	         -c -I$(INCINSTALLDIR) $(HDRS) LinkDef.h
                                                              
